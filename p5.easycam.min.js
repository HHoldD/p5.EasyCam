(function(){const c={LIBRARY:"p5.EasyCam",VERSION:"1.0.1",AUTHOR:"Thomas Diewald",SOURCE:"https://github.com/diwi/p5.EasyCam",toString:function(){return this.LIBRARY+" v"+this.VERSION+" by "+this.AUTHOR+" ("+this.SOURCE+")"}};var e=class{constructor(m,n){if(!(m instanceof p5.RendererGL))return void console.log("renderer needs to be an instance of p5.RendererGL");n=n||{},n.distance===void 0&&(n.distance=500),n.center===void 0&&(n.center=[0,0,0]),n.rotation===void 0&&(n.rotation=i.identity()),n.viewport===void 0&&(n.viewport=[0,0,m.width,m.height]),this.INFO=c,this.setCanvas(m);var o=this;this.cam=o,this.LOOK=[0,0,1],this.UP=[0,1,0],this.AXIS=new function(){this.YAW=1,this.PITCH=2,this.ROLL=4,this.ALL=this.YAW|this.PITCH|this.ROLL},this.SHIFT_CONSTRAINT=0,this.FIXED_CONSTRAINT=0,this.DRAG_CONSTRAINT=0,this.scale_rotation=1e-3,this.scale_pan=2e-4,this.scale_zoom=1e-3,this.scale_zoomwheel=20,this.default_interpolation_time=300,this.distance_min_limit=0.01,this.distance_min=1,this.distance_max=Number.MAX_VALUE,this.state={distance:n.distance,center:n.center.slice(),rotation:n.rotation.slice(),copy:function(p){return p=p||{},p.distance=this.distance,p.center=this.center.slice(),p.rotation=this.rotation.slice(),p}},this.state_reset=this.state.copy(),this.state_pushed=this.state.copy(),this.viewport=n.viewport.slice(),this.mouse={cam:o,curr:[0,0],prev:[0,0],dist:[0,0],mwheel:0,isPressed:!1,shiftKeyDown:!1,mouseDragLeft:o.mouseDragRotate,mouseDragCenter:o.mouseDragPan,mouseDragRight:o.mouseDragZoom,mouseWheelAction:o.mouseWheelZoom,insideViewport:function(p,q){var r=o.viewport[0],u=r+o.viewport[2],v=o.viewport[1],A=v+o.viewport[3];return p>r&&p<u&&q>v&&q<A},updateDragConstraint:function(){var p=this.dist[0],q=this.dist[1],r=o.P5.keyIsDown(o.P5.SHIFT);r||this.shiftKeyDown===r||(o.SHIFT_CONSTRAINT=0),this.shiftKeyDown=r,this.shiftKeyDown&&!o.SHIFT_CONSTRAINT&&1<Math.abs(p-q)&&(o.SHIFT_CONSTRAINT=Math.abs(p)>Math.abs(q)?o.AXIS.YAW:o.AXIS.PITCH),o.DRAG_CONSTRAINT=o.AXIS.ALL,o.FIXED_CONSTRAINT&&(o.DRAG_CONSTRAINT=o.FIXED_CONSTRAINT),o.SHIFT_CONSTRAINT&&(o.DRAG_CONSTRAINT=o.SHIFT_CONSTRAINT)},pressed:function(p){var q=p.x,r=p.y;this.insideViewport(q,r)&&(this.curr[0]=this.prev[0]=q,this.curr[1]=this.prev[1]=r,this.dist[0]=0,this.dist[1]=0,this.isPressed=!0,o.SHIFT_CONSTRAINT=0)},update:function(){this.isPressed&&(this.prev[0]=this.curr[0],this.prev[1]=this.curr[1],this.curr[0]=o.P5.mouseX,this.curr[1]=o.P5.mouseY,this.dist[0]=-(this.curr[0]-this.prev[0]),this.dist[1]=-(this.curr[1]-this.prev[1]),this.updateDragConstraint(),o.P5.mouseButton===o.P5.LEFT&&this.mouseDragLeft&&this.mouseDragLeft(),o.P5.mouseButton===o.P5.CENTER&&this.mouseDragCenter&&this.mouseDragCenter(),o.P5.mouseButton===o.P5.RIGHT&&this.mouseDragRight&&this.mouseDragRight())},released:function(){this.isPressed=!1,o.SHIFT_CONSTRAINT=0},clicked:function(p){var q=p.x,r=p.y;if(this.insideViewport(q,r)){this.time=this.time||0;var u=p.timeStamp-this.time;this.time=p.timeStamp,u<this.doubleClickTime&&this.doubleClicked(p)}},doubleClickTime:200,doubleClicked:function(){o.reset()},wheel:function(p){var q=p.x,r=p.y;this.insideViewport(q,r)&&(this.mwheel=0.01*p.deltaY,this.mouseWheelAction&&this.mouseWheelAction())}},this.renderer&&(this.renderer.mousePressed(function(p){passive:;o.mouse.pressed(p),p.preventDefault()}),this.renderer.mouseReleased(function(p){passive:;o.mouse.released(p)}),this.renderer.mouseClicked(function(p){passive:;o.mouse.clicked(p)}),this.renderer.mouseWheel(function(p){passive:;o.mouse.wheel(p)})),this.auto_update=!0,p5.prototype.registerMethod("pre",function(){o.auto_update&&o.update()}),this.dampedZoom=new f(this,function(p){o.zoom(p*o.getZoomMult())}),this.dampedPanX=new f(this,function(p){o.panX(p*o.getPanMult())}),this.dampedPanY=new f(this,function(p){o.panY(p*o.getPanMult())}),this.dampedRotX=new f(this,function(p){o.rotateX(p*o.getRotationMult())}),this.dampedRotY=new f(this,function(p){o.rotateY(p*o.getRotationMult())}),this.dampedRotZ=new f(this,function(p){o.rotateZ(p*o.getRotationMult())}),this.timedRot=new g(this,this.setInterpolatedRotation),this.timedPan=new g(this,this.setInterpolatedCenter),this.timedzoom=new g(this,this.setInterpolatedDistance)}getAutoUpdate(){return this.auto_update}setAutoUpdate(m){this.auto_update=m}getCanvas(){return this.renderer}setCanvas(m){m instanceof p5.RendererGL?(this.renderer=m,this.graphics=m._pInst instanceof p5?m:m._pInst,this.P5=this.graphics._pInst):(this.graphics=void 0,this.renderer=void 0)}setViewport(m){this.viewport=m.slice()}getViewport(){return this.viewport}update(){var m=this.cam,n=m.mouse;n.update();var o=!1;o|=m.dampedZoom.update(),o|=m.dampedPanX.update(),o|=m.dampedPanY.update(),o|=m.dampedRotX.update(),o|=m.dampedRotY.update(),o|=m.dampedRotZ.update(),o?(m.timedRot.stop(),m.timedPan.stop(),m.timedzoom.stop()):(m.timedRot.update(),m.timedPan.update(),m.timedzoom.update()),m.apply()}apply(m){var n=this.cam;m=m||n.renderer;m&&(this.camEYE=this.getPosition(this.camEYE),this.camLAT=this.getCenter(this.camLAT),this.camRUP=this.getUpVector(this.camRUP),m.camera(this.camEYE[0],this.camEYE[1],this.camEYE[2],this.camLAT[0],this.camLAT[1],this.camLAT[2],this.camRUP[0],this.camRUP[1],this.camRUP[2]))}mouseWheelZoom(){var m=this,n=this.cam;n.dampedZoom.addForce(m.mwheel*n.scale_zoomwheel)}mouseDragZoom(){var m=this,n=this.cam;n.dampedZoom.addForce(-m.dist[1])}mouseDragPan(){var m=this,n=this.cam;n.dampedPanX.addForce(n.DRAG_CONSTRAINT&n.AXIS.YAW?m.dist[0]:0),n.dampedPanY.addForce(n.DRAG_CONSTRAINT&n.AXIS.PITCH?m.dist[1]:0)}mouseDragRotate(){var m=this,n=this.cam,o=m.curr[0],p=m.curr[1],q=m.dist[0],r=m.dist[1],u=2*Math.min(Math.max((o-n.viewport[0])/n.viewport[2],0),1)-1,v=2*Math.min(Math.max((p-n.viewport[1])/n.viewport[3],0),1)-1;n.DRAG_CONSTRAINT&n.AXIS.YAW&&n.dampedRotY.addForce(+q*(1-v*v)),n.DRAG_CONSTRAINT&n.AXIS.PITCH&&n.dampedRotX.addForce(-r*(1-u*u)),n.DRAG_CONSTRAINT&n.AXIS.ROLL&&(n.dampedRotZ.addForce(-q*v),n.dampedRotZ.addForce(+r*u))}getZoomMult(){return this.state.distance*this.scale_zoom}getPanMult(){return this.state.distance*this.scale_pan}getRotationMult(){return Math.pow(Math.log10(1+this.state.distance),0.5)*this.scale_rotation}zoom(m){var n=this.cam,o=n.state.distance+m;o<n.distance_min&&(o=n.distance_min,n.dampedZoom.stop()),o>n.distance_max&&(o=n.distance_max,n.dampedZoom.stop()),n.state.distance=o}panX(m){var n=this.cam.state;if(m){var o=i.applyToVec3(n.rotation,[m,0,0]);k.add(n.center,o,n.center)}}panY(m){var n=this.cam.state;if(m){var o=i.applyToVec3(n.rotation,[0,m,0]);k.add(n.center,o,n.center)}}pan(m){this.cam.panX(m),this.cam.panY(m)}rotateX(m){this.cam.rotate([1,0,0],m)}rotateY(m){this.cam.rotate([0,1,0],m)}rotateZ(m){this.cam.rotate([0,0,1],m)}rotate(m,n){var o=this.cam.state;if(n){var p=i.create({axis:m,angle:n});i.applyToRotation(o.rotation,p,o.rotation)}}setInterpolatedDistance(m,n,o){this.cam.state.distance=j.mix(m,n,j.smoothstep(o))}setInterpolatedCenter(m,n,o){this.cam.state.center=k.mix(m,n,j.smoothstep(o))}setInterpolatedRotation(m,n,o){this.cam.state.rotation=i.slerp(m,n,o)}setDistanceMin(m){this.distance_min=Math.max(m,this.distance_min_limit),this.zoom(0)}setDistanceMax(m){this.distance_max=m,this.zoom(0)}setDistance(m,n){this.timedzoom.start(this.state.distance,m,n,[this.dampedZoom])}getDistance(){return this.state.distance}setCenter(m,n){this.timedPan.start(this.state.center,m,n,[this.dampedPanX,this.dampedPanY])}getCenter(){return this.state.center}setRotation(m,n){this.timedRot.start(this.state.rotation,m,n,[this.dampedRotX,this.dampedRotY,this.dampedRotZ])}getRotation(){return this.state.rotation}getPosition(m){var n=this.cam,o=n.state;return m=k.assert(m),i.applyToVec3(o.rotation,n.LOOK,m),k.mult(m,o.distance,m),k.add(m,o.center,m),m}getUpVector(m){var n=this.cam,o=n.state;return m=k.assert(m),i.applyToVec3(o.rotation,n.UP,m),m}getState(){return this.state.copy()}setState(m,n){m&&(this.setDistance(m.distance,n),this.setCenter(m.center,n),this.setRotation(m.rotation,n))}pushState(){return this.state_pushed=this.getState()}popState(m){this.setState(this.state_pushed,m)}pushResetState(){return this.state_reset=this.getState()}reset(m){this.setState(this.state_reset,m)}setRotationScale(m){this.scale_rotation=m}setPanScale(m){this.scale_pan=m}setZoomScale(m){this.scale_zoom=m}getRotationScale(){return this.scale_rotation}getPanScale(){return this.scale_pan}getZoomScale(){return this.scale_zoom}getWheelScale(){return this.scale_zoomwheel}setWheelScale(m){this.scale_zoomwheel=m}setDamping(m){this.dampedZoom.damping=m,this.dampedPanX.damping=m,this.dampedPanY.damping=m,this.dampedRotX.damping=m,this.dampedRotY.damping=m,this.dampedRotZ.damping=m}setDefaultInterpolationTime(m){this.default_interpolation_time=m}getDefaultInterpolationTime(){return this.default_interpolation_time}setRotationConstraint(m,n,o){var p=this.cam;p.FIXED_CONSTRAINT=0,p.FIXED_CONSTRAINT|=m?p.AXIS.YAW:0,p.FIXED_CONSTRAINT|=n?p.AXIS.PITCH:0,p.FIXED_CONSTRAINT|=o?p.AXIS.ROLL:0}beginHUD(m,n,o){var p=this.cam;if(m=m||p.renderer,!!m){m.push();var q=m.drawingContext,n=void 0===n?m.width:n,o=void 0===o?m.height:o,r=Number.MAX_VALUE;q.flush(),q.disable(q.DEPTH_TEST),this.pushed_uMVMatrix=m.uMVMatrix.copy(),this.pushed_uPMatrix=m.uPMatrix.copy(),m.resetMatrix(),m.ortho(0,n,-o,0,-r,+r)}}endHUD(m){var n=this.cam;if(m=m||n.renderer,!!m){var o=m.drawingContext;o.flush(),m.uMVMatrix.set(this.pushed_uMVMatrix),m.uPMatrix.set(this.pushed_uPMatrix),o.enable(o.DEPTH_TEST),m.pop()}}},f=class{constructor(m,n){this.cam=m,this.value=0,this.damping=0.85,this.action=n}addForce(m){this.value+=m}update(){var m=1e-6<this.value*this.value;return m?(this.action(this.value),this.value*=this.damping):this.stop(),m}stop(){this.value=0}},g=class{constructor(m,n){this.cam=m,this.action=n}start(m,n,o,p){for(var q in p)p[q].stop();this.valA=m,this.valB=n,this.duration=o===void 0?this.cam.default_interpolation_time:o,this.timer=new Date().getTime(),this.active=0<this.duration,this.active||this.interpolate(1)}update(){if(this.active){var m=(new Date().getTime()-this.timer)/this.duration;0.995<m?(this.interpolate(1),this.stop()):this.interpolate(m)}}interpolate(m){this.action(this.valA,this.valB,m)}stop(){this.active=!1}},i={assert:function(m){return m===void 0||m.constructor!==Array?[1,0,0,0]:m},identity:function(){return[1,0,0,0]},applyToVec3:function(m,n,o){var p=n[0],q=n[1],r=n[2],u=m[0],v=m[1],A=m[2],B=m[3],C=v*p+A*q+B*r;return o=k.assert(o),o[0]=2*(u*(p*u-(A*r-B*q))+C*v)-p,o[1]=2*(u*(q*u-(B*p-v*r))+C*A)-q,o[2]=2*(u*(r*u-(v*q-A*p))+C*B)-r,o},applyToRotation(m,n,o){var p=m[0],q=m[1],r=m[2],u=m[3],v=n[0],A=n[1],B=n[2],C=n[3];return o=i.assert(o),o[0]=v*p-(A*q+B*r+C*u),o[1]=A*p+v*q+(B*u-C*r),o[2]=B*p+v*r+(C*q-A*u),o[3]=C*p+v*u+(A*r-B*q),o},slerp:function(m,n,o,p){var q=m[0],r=m[1],u=m[2],v=m[3],A=n[0],B=n[1],C=n[2],D=n[3],E=q*A+r*B+u*C+v*D;0>E&&(A=-A,B=-B,C=-C,D=-D,E=-E);var H,I,F=Math.acos(E),G=Math.sqrt(1-E*E);return 1e-3<G?(H=Math.sin((1-o)*F)/G,I=Math.sin(o*F)/G):(H=1-o,I=o),p=i.assert(p),p[0]=H*q+I*A,p[1]=H*r+I*B,p[2]=H*u+I*C,p[3]=H*v+I*D,i.create({rotation:p,normalize:!0},p)},create:function(m,n){if(n=i.assert(n),m.axis){var o=m.axis,p=m.angle,q=k.mag(o);if(0==q)return;var r=-0.5*p,u=Math.sin(r)/q;return n[0]=Math.cos(r),n[1]=u*o[0],n[2]=u*o[1],n[3]=u*o[2],n}if(m.rotation){if(n[0]=m.rotation[0],n[1]=m.rotation[1],n[2]=m.rotation[2],n[3]=m.rotation[3],m.normalize){var v=1/Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]+n[3]*n[3]);n[0]*=v,n[1]*=v,n[2]*=v,n[3]*=v}return n}if(m.angles_xyz){var A=-0.5*m.angles_xyz[0],B=-0.5*m.angles_xyz[1],C=-0.5*m.angles_xyz[2],D=[Math.cos(A),Math.sin(A),0,0],E=[Math.cos(B),0,Math.sin(B),0],F=[Math.cos(C),0,0,Math.sin(C)];return i.applyToRotation(E,F,n),i.applyToRotation(D,n,n),n}}},j={mix:function(m,n,o){return m*(1-o)+n*o},smoothstep:function(m){return m*m*(3-2*m)},smootherstep:function(){return x*x*x*(x*(6*x-15)+10)}},k={assert:function(m){return m===void 0||m.constructor!==Array?[0,0,0]:m},isScalar:function(m){return m!==void 0&&m.constructor!==Array},add:function(m,n,o){return o=this.assert(o),this.isScalar(n)?(o[0]=m[0]+n,o[1]=m[1]+n,o[2]=m[2]+n):(o[0]=m[0]+n[0],o[1]=m[1]+n[1],o[2]=m[2]+n[2]),o},mult:function(m,n,o){return o=this.assert(o),this.isScalar(n)?(o[0]=m[0]*n,o[1]=m[1]*n,o[2]=m[2]*n):(o[0]=m[0]*n[0],o[1]=m[1]*n[1],o[2]=m[2]*n[2]),o},magSq:function(m){return m[0]*m[0]+m[1]*m[1]+m[2]*m[2]},mag:function(m){return Math.sqrt(m[0]*m[0]+m[1]*m[1]+m[2]*m[2])},dot:function(m,n){return m[0]*n[0]+m[1]*n[1]+m[2]*n[2]},cross:function(m,n,o){return o=this.assert(o),o[0]=m[1]*n[2]-m[2]*n[1],o[1]=m[2]*n[0]-m[0]*n[2],o[2]=m[0]*n[1]-m[1]*n[0],o},angle:function(m,n){var o=this.mag(m)*this.mag(n);if(0==o)return 0;var p=this.dot(m,n),q=0.9999*o;if(p<-q||p>q){var r=this.cross(m,n);return 0<=p?Math.asin(this.mag(r)/o):Math.PI-Math.asin(this.mag(r)/o)}return Math.acos(p/o)},mix(m,n,o,p){return p=this.assert(p),p[0]=j.mix(m[0],n[0],o),p[1]=j.mix(m[1],n[1],o),p[2]=j.mix(m[2],n[2],o),p}};e.INFO=c,Object.freeze(c),Dw={EasyCam:e,DampedAction:f,Interpolation:g,Rotation:i,Vec3:k,Scalar:j},p5&&(!p5.prototype.hasOwnProperty("glInfo")&&(p5.prototype.glInfo=function(){return this._renderer.glInfo.apply(this._renderer,arguments)},p5.RendererGL.prototype.glInfo=function(){var m=this.drawingContext,n={};n.gl=this.drawingContext;var o=m.getExtension("WEBGL_debug_renderer_info");return o&&(n.gpu_renderer=m.getParameter(o.UNMASKED_RENDERER_WEBGL),n.gpu_vendor=m.getParameter(o.UNMASKED_VENDOR_WEBGL)),n.wgl_renderer=m.getParameter(m.RENDERER),n.wgl_version=m.getParameter(m.VERSION),n.wgl_glsl=m.getParameter(m.SHADING_LANGUAGE_VERSION),n.wgl_vendor=m.getParameter(m.VENDOR),n}),!p5.prototype.hasOwnProperty("createEasyCam")&&(p5.prototype.createEasyCam=function(){var m=this._renderer,n=arguments[0];return arguments[0]instanceof p5.RendererGL&&(m=arguments[0],n=arguments[1]),new Dw.EasyCam(m,n)}),p5.prototype.ortho=function(){return this._renderer.ortho.apply(this._renderer,arguments),this},p5.RendererGL.prototype.ortho=function(m,n,o,p,q,r){m===void 0&&(m=-this.width/2),n===void 0&&(n=+this.width/2),o===void 0&&(o=-this.height/2),p===void 0&&(p=+this.height/2),q===void 0&&(q=0),r===void 0&&(r=Math.max(this.width,this.height));var u=n-m,v=p-o,A=r-q,E=-(n+m)/u,F=-(p+o)/v,G=-(r+q)/A;this.uPMatrix=p5.Matrix.identity(),this.uPMatrix.set(2/u,0,0,0,0,-(2/v),0,0,0,0,-2/A,0,E,F,G,1),this._curCamera="custom"})})();var Dw;